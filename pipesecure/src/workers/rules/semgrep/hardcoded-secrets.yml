rules:
  - id: pipesecure.hardcoded-api-key
    patterns:
      - pattern-either:
          - pattern: $KEY = "AKIA..."
          - pattern: $KEY = "sk-..."
          - pattern: $KEY = "ghp_..."
          - pattern: $KEY = "gho_..."
          - pattern: $KEY = "github_pat_..."
      - pattern-not-inside: |
          // $...COMMENT
          $KEY = "..."
    message: >
      Hardcoded API key or secret detected. Move secrets to environment
      variables or a secret management service.
    severity: ERROR
    languages: [javascript, typescript, python, java, go, ruby]
    metadata:
      cwe: ["CWE-798"]
      owasp: ["A07:2021"]
      confidence: high

  - id: pipesecure.hardcoded-password
    patterns:
      - pattern-either:
          - pattern: |
              password = "..."
          - pattern: |
              const password = "..."
          - pattern: |
              let password = "..."
          - pattern: |
              PASSWORD = "..."
      - pattern-not: |
          password = ""
      - pattern-not: |
          const password = ""
    message: >
      Hardcoded password detected. Use environment variables
      or a secrets manager.
    severity: ERROR
    languages: [javascript, typescript, python]
    metadata:
      cwe: ["CWE-798"]
      confidence: medium
